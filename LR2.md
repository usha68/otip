## Лабораторная работа №2. Поиск в Elasticsearch.

### Отчёт
Личная демонстрация работы макета + результаты в личном репозитории + электронный отчёт (включает задание, листинг, скриншоты результатов), оформленный в кафедральном шаблоне и в соответствии с требованиями.


### Задание
Вариант определяется по номеру из fullname. Для  2020-3-X-iva берём X, и номер варианта определяется как X % k, где k - число вариантов. Всюду fullname должен быть вашим.

В разработанном скрипте поддерживать как длинные, так и короткие ключи. Где флаг не указан, применяется позиционный аргумент. Скрипт должен быть один, первый аргумент трактовать как команду для выбора действия, всё остальное - параметры этого скрипта. Логика работы как у команды git в связке git add, git push.

1. Создать макет, состоящий из серверной части (запущенный elasticsearch) и клиентской части (докер-образ с python-скриптами, называть по формату fullname-lr2). Аргументы скриптов передавать через командную строку.
1. Создать индекс по своему fullname и mapping для названия, автора, года издания и содержимого книги. Токенизатор должен быть настроен для русского языка, фильтр токенов - на стоп-слова русского языка и слова "князь", "повезет", "сорок".
    ```bash
    sudo docker run -v 020-3-5-iva-lr2 create
    ```
1. Реализовать возможность загрузки заданного файла в elasticsearch. Автора, название, год и путь к файлу передавать параметрами. Пример запуска
    ```bash
    sudo docker run -v `pwd`/input:/input 2020-3-5-iva-lr2 add-book --author Tolstoy --year 1865 --name ВойнаИМир voyna-i-mir.txt
    ```
1. Реализовать возможность загрузки всех файлов в каталоге, названных по формату "название - автор - год издания". Пробелы игнорировать
   ```bash
    sudo docker run -v `pwd`/input:/input 2020-3-5-iva-lr2 add-books books
    ```
    Все книги из каталога input/books должны быть загружены. Если название книги не соответствует шаблону, то не загружать. Примеры валидных названий "Песня -  Иванов - 1992" (надо выделить "Песня", "Иванов" и "1992"), "111 - Петров Иван - 1999  " ("111" "Петров Иван" и "1999").
1. Реализовать поиска всех книг с заданным словом. Выводить количество книг с этим словом, а ниже - список этих книг с авторами и годом издания.
   ```bash
    sudo docker run -v 2020-3-5-iva-lr2 count-books-with-words гидроэлектростанция
    Найдено: 2
    Война и мир, Толстой, 1865
    Евгений Онегин, Пушкин, 1831
    ```
1. Реализовать поиска всех книги заданного автора, которые содержат заданную строку.
   ```bash
    sudo docker run -v 2020-3-5-iva-lr2 search-books --author Толстой гидроэлектростанция
    Найдено: 1
    Война и мир, Толстой, 1865
    ```
1. Реализовать поиска всех из указанного диапазона годов, которые не содержат заданную строку.
    ```bash
    sudo docker run -v 2020-3-5-iva-lr2 search-dates --from 1800 --till 1900 марцепан
    Найдено: 1
    Война и мир, Толстой, 1865
    ```
1. Вычислить среднее арифметическое для года издания заданного автора
    ```bash
    sudo docker run -v 2020-3-5-iva-lr2 calc-date --author Толстой
    1860
    ```
1. Вывести топ-10 самых популярных слов с количеством их упоминаний во всех книгах заданного года.
    ```bash
    sudo docker run -v 2020-3-5-iva-lr2 top-words --date 1860
    Автор 50
    Гектор 30
    ...
    ```